<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>bodyfat</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="bodyfat_files/libs/clipboard/clipboard.min.js"></script>
<script src="bodyfat_files/libs/quarto-html/quarto.js"></script>
<script src="bodyfat_files/libs/quarto-html/popper.min.js"></script>
<script src="bodyfat_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="bodyfat_files/libs/quarto-html/anchor.min.js"></script>
<link href="bodyfat_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="bodyfat_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="bodyfat_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="bodyfat_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="bodyfat_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="risk-of-heart-disease-using-adiposity-measures" class="level1">
<h1>Risk of heart disease using adiposity measures</h1>
<p>We assume heart disease risk is related to adiposity, but we don’t want to do underwater weighing, we want a measure that we can take in a doctors office and get a risk score…</p>
<p>Using a dataset from lib.stat.cmu.edu/datasets/bodyfat for men we show how we can calculate that.</p>
<section id="dimensionless-formulation" class="level2">
<h2 class="anchored" data-anchor-id="dimensionless-formulation">Dimensionless Formulation</h2>
<p>No physical process can depend directly on the value of a dimensional quantity such as a pressure or a length, because these quantities vary with our choice of units so we are free to make the quantity anything we want by choice of units. Only dimensionless quantities do not have this property, so only dimensionless quantities ultimately are truly determinates of physical processes.</p>
<p>We assume that height, weight, circumference of the belly, and the density of lean body mass are 4 important variables sufficient for our purposes. The Buckingham Pi Theorem tells us that since we have 3 fundamental dimensions: mass, length, time, we can reformulate the problem into 4-3 = 1 dimensionless group which indexes the function of interest. Technically time enters into the system in the conversion between weight and mass as <code>force = mass * acceleration</code>. Please note that most metric scales read out in “kg” because they assume you are on the surface of the earth. If you get a reading in mass units vs in force units please be careful.</p>
<p>In this case we will formulate an “adiposity index” which increases when an estimate of the person’s density decreases (because fat is lower density than lean meat).</p>
<p>The adiposity index is a dimensionless number which everyone will calculate the same as long as they use consistent units (always measuring mass in one units, lengths in another etc). It measures the ratio of the density of lean meat to the density of a “notional person” with the given mass and shaped like a cylinder of same height and with circumference equal to the waist circumference.</p>
<p>The adiposity index clearly gives a strong predictor of actual measured density, and from that estimated percentage body fat.</p>
<p><span class="math display">\[
    A = \frac{\rho_w}{m/(h \pi (c/(2 \pi))^2)} = \frac{\rho_w h c^2}{4 \pi m}
\]</span></p>
<p>Instead of <span class="math inline">\(m\)</span> we can use <span class="math inline">\(w/g\)</span> if we have a weight in Newtons or lbf. Note that if we <em>are</em> on the surface of the earth, we can read off kg or lbm directly. We take <span class="math inline">\(\rho_w = 1000\)</span> kg/m^3 as the notional typical density of water which is close enough to density of lean body mass. It’s role is to give us a dimensional number whose size is about 1 which is usually a good thing for doing analysis with dimensionless ratios.</p>
<p>Given our dataset has multiple units of measurement, we convert everything to kg and meters so all quantities are in known consistent units, which ensures we get a proper dimensionless quantity with no extra conversion factors.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CSV</span>,<span class="bu">StatsPlots</span>,<span class="bu">DataFrames</span>,<span class="bu">DataFramesMeta</span>,<span class="bu">StatsBase</span>,<span class="bu">GLM</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>dat <span class="op">=</span> CSV.<span class="fu">read</span>(<span class="st">"bodyfat.csv"</span>,DataFrame; header<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>kgperlb <span class="op">=</span> <span class="fl">0.45359237</span> <span class="co"># this ultimately incorporates conversion between lbf of weight and kg of mass</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>cmperin <span class="op">=</span> <span class="fl">2.54</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>densmeat <span class="op">=</span> <span class="fl">1000.0</span> <span class="co">#kg/m^3 (about, this is density of water which is going to be close)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>dat.adiposity <span class="op">=</span> densmeat <span class="op">./</span> (dat.weightlbs <span class="op">*</span> kgperlb <span class="op">./</span> (<span class="cn">pi</span> <span class="op">.*</span> (dat.heightinch <span class="op">.*</span> cmperin <span class="op">./</span> <span class="fl">100.0</span>)<span class="op">.*</span>((dat.abdomcm <span class="op">./</span> <span class="fl">100.0</span>) <span class="op">./</span> (<span class="fl">2.0</span><span class="op">*</span><span class="cn">pi</span>))<span class="op">.^</span><span class="fl">2</span>)) </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># one 44 year old guy has reported weight of 205 lbs and height of 29.5 inches</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># clearly a measurement error in height, or he has no legs or something unusual</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># eliminating him</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>dat <span class="op">=</span> <span class="pp">@subset</span>(dat, <span class="op">:</span>heightinch <span class="op">.&gt;</span> <span class="fl">30.0</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>dat.bmi <span class="op">=</span> <span class="pp">@df</span> dat <span class="fu">identity</span>((<span class="op">:</span>weightlbs <span class="op">.*</span> kgperlb) <span class="op">./</span> (<span class="op">:</span>heightinch <span class="op">.*</span> cmperin <span class="op">./</span> <span class="fl">100.0</span>)<span class="op">.^</span><span class="fl">2</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="pp">@df</span> dat <span class="fu">scatter</span>(<span class="op">:</span>adiposity, <span class="op">:</span>specgrav; title<span class="op">=</span><span class="st">"Measured Density vs Adiposity Index"</span>, xlab<span class="op">=</span><span class="st">"Adiposity Index"</span>,ylab<span class="op">=</span><span class="st">"Specific Gravity"</span>, legend<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(p)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="pp">@df</span> dat <span class="fu">scatter</span>(<span class="op">:</span>adiposity, <span class="op">:</span>pctfat; title<span class="op">=</span><span class="st">"Estimated Body Fat vs Adiposity Index"</span>, xlab<span class="op">=</span><span class="st">"Adiposity Index"</span>,ylab<span class="op">=</span><span class="st">"Percent Body Fat"</span>, legend<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(p)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">## compare adiposity to BMI</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="pp">@df</span> dat <span class="fu">scatter</span>(<span class="op">:</span>adiposity, <span class="op">:</span>bmi;</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"BMI vs Adiposity"</span>,xlab<span class="op">=</span><span class="st">"Adiposity (dimensionless)"</span>, ylab<span class="op">=</span><span class="st">"BMI (kg/m^2)"</span>,label<span class="op">=</span><span class="cn">false</span>,legend<span class="op">=:</span>topleft)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>([<span class="fl">1.0</span>,<span class="fl">2.0</span>,<span class="cn">missing</span>,<span class="fl">1.0</span>,<span class="fl">2.0</span>],[<span class="fl">30.0</span>,<span class="fl">30.0</span>,<span class="cn">missing</span>,<span class="fl">25.0</span>,<span class="fl">25.0</span>]; label<span class="op">=</span><span class="st">"BMI Thresholds"</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>([<span class="fl">1.75</span>,<span class="fl">1.75</span>,<span class="cn">missing</span>,<span class="fl">1.65</span>,<span class="fl">1.65</span>],[<span class="fl">15.0</span>,<span class="fl">45.0</span>,<span class="cn">missing</span>,<span class="fl">15.0</span>,<span class="fl">45.0</span>]; color <span class="op">=</span> <span class="st">"blue"</span>, label<span class="op">=</span><span class="st">"Adiposity Thresholds"</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">annotate!</span>([(<span class="fl">1.0</span>,<span class="fl">27.0</span>,(<span class="st">"BMI Overweight"</span>,<span class="op">:</span>left)),(<span class="fl">1.0</span>,<span class="fl">33.0</span>,(<span class="st">"BMI Obese"</span>, <span class="op">:</span>left))])</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(p)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">## compare BMI to percent body fat:</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="pp">@df</span> dat <span class="fu">scatter</span>(<span class="op">:</span>bmi,<span class="op">:</span>pctfat)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>dat.bmicat <span class="op">=</span> <span class="fu">map</span>(x <span class="op">-&gt;</span> (x <span class="op">&gt;</span> <span class="fl">30.0</span>) ? <span class="fl">2</span> <span class="op">:</span> (x <span class="op">&gt;</span> <span class="fl">25.0</span> ? <span class="fl">1</span> <span class="op">:</span> <span class="fl">0</span>), dat.bmi)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="pp">@df</span> dat <span class="fu">scatter</span>(<span class="op">:</span>adiposity,<span class="op">:</span>pctfat;color<span class="op">=:</span>bmicat,legend<span class="op">=:</span><span class="cn">false</span>,title<span class="op">=</span><span class="st">"% Body Fat vs Adiposity</span><span class="sc">\n</span><span class="st">Color = BMI: Normal, Overweight, Obese"</span>,xlab<span class="op">=</span><span class="st">"Adiposity (dimensionless)"</span>,ylab<span class="op">=</span><span class="st">"Percent Body Fat Estimate"</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dat.adiposity)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>mod <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(pctfat <span class="op">~</span> adiposity ),dat)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>Plots.<span class="fu">abline!</span>(<span class="fu">coef</span>(mod)[<span class="fl">2</span>],<span class="fu">coef</span>(mod)[<span class="fl">1</span>])</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(p)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">density</span>(dat.adiposity; title<span class="op">=</span><span class="st">"Adiposity distribution (males)"</span>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="bodyfat_files/figure-html/cell-2-output-1.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="bodyfat_files/figure-html/cell-2-output-2.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="bodyfat_files/figure-html/cell-2-output-3.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="bodyfat_files/figure-html/cell-2-output-4.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="bodyfat_files/figure-html/cell-2-output-5.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="some-comments" class="level2">
<h2 class="anchored" data-anchor-id="some-comments">Some comments:</h2>
<p>If you were to go along with the idea of dividing people into three major groups “normal adiposity”, “overweight”, and “obese”, this is done using BMI with the thresholds 25 and 30 using kg/m^2.</p>
<p>In the above graph we compare that division with a division along the adiposity index axis at 1.65 and 1.75 (dimensionless). These were just picked out by eye from the graph, but notice the following:</p>
<ol type="1">
<li>Only about half of the people classified as adiposity index obese (above 1.75) are classified as obese by BMI.</li>
<li>By eye, I’m guessing about 75% of people classified as “overweight” by BMI are below the 1.65 threshold for overweight by adiposity index.</li>
<li><strong>Many</strong> people classified as overweight by BMI are very “average” adiposity index, around 1.5</li>
<li>To set an adiposity index threshold that would catch “most” of the people classified as Overweight or Obese by BMI would require setting that threshold very low, below average, perhaps as low as 1.3 or so. This would include a considerable majority of men and is not plausibly a reasonable category. Therefore MANY people classified as overweight by BMI are NOT.</li>
</ol>
<p>In the final graph we see that by BMI there are a considerable number of people who are considered “overweight” (blue) who have body fat percentages below 20, some of them even below 10%. There are also a considerable number of people who are considered overweight but NOT obese who have estimated body fat percentage into the 25-35% range.</p>
</section>
</section>
<section id="a-digression-on-why-the-adiposity-scale-is-meaningful" class="level1">
<h1>A digression on why the adiposity scale is meaningful</h1>
<p>One objection to this adiposity scale is that it doesn’t take into account the fact that as animals get taller their bones make up a bigger fraction of their cross section to compensate for the increased pressures they undergo. I believe this is a “second order” effect which is ignorable for the purposes described here. Here is a basic argument regarding that.</p>
<p>Water and muscle have approximately the same density, let’s measure density as a fraction of water, so muscle has density about 1, on this scale bone has density about 1.8 and fat has density about 0.9</p>
<p>If we consider a low-body-fat person who is on the short end of the human scale, say 5ft tall, and we scale them up by just multiplying all the lengths in their body by 6/5 then they will be 6ft tall. How different would this scaled person be compared to an actual person who is 6ft tall? If we do pure geometric scaling, then the percentage of the volume taken up by bone would be the same in the two. That’s probably not correct. Over this small range of differences, it might be appropriate to say that the fraction of the body which is bone is near constant, but varies linearly with height. In other words:</p>
<p><span class="math display">\[
f_{bone} = f_0 + k h
\]</span></p>
<p>As a first approximation <span class="math inline">\(f_0\)</span> should be something like 0.15 according to for example <a href="https://en.wikipedia.org/wiki/Human_skeleton">Wikipedia article on skeleton</a>. Let’s measure h as a fraction of the <a href="https://en.wikipedia.org/wiki/Robert_Wadlow">Tallest Man Ever</a> who was about 8ft 11in (272 cm). On this scale people from 4.5ft to 6.5 ft which is the bulk of human heights range over about <span class="math inline">\(h \in [.50,.73]\)</span> with typical value for males perhaps .66</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>wadlh <span class="op">=</span> <span class="fl">8.0</span><span class="op">+</span><span class="fl">11.0</span><span class="op">/</span><span class="fl">12</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>lowh <span class="op">=</span> <span class="fl">4.5</span><span class="op">/</span>wadlh</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>typh <span class="op">=</span> (<span class="fl">5</span><span class="op">+</span><span class="fl">11</span><span class="op">/</span><span class="fl">12</span>)<span class="op">/</span>wadlh</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>highh <span class="op">=</span> <span class="fl">6.5</span><span class="op">/</span>wadlh</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"low h = </span><span class="sc">$</span>lowh<span class="st">, typical h = </span><span class="sc">$</span>typh<span class="st">, high h = </span><span class="sc">$</span>highh<span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>low h = 0.5046728971962617, typical h = 0.663551401869159, high h = 0.7289719626168225</code></pre>
</div>
</div>
<p>If we want to model the weight of a “healthy athletic” person as a function of height, we can imagine that they scale as follows:</p>
<p><span class="math display">\[
W = 1.8 f h^3 + 1.0 (1-f) h^3\
f = 0.15 + k (h - .6)
\]</span></p>
<p>Let’s do the math symbolically in Julia</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Symbolics</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@variables</span> w f h k</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>wexpr <span class="op">=</span> <span class="fl">1.8</span> <span class="op">*</span> f <span class="op">*</span> h<span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">1.0</span> <span class="fu">*</span>(<span class="fl">1</span><span class="op">-</span>f)<span class="op">*</span>h<span class="op">^</span><span class="fl">3</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>fexpr <span class="op">=</span> <span class="fl">0.15</span> <span class="op">+</span> k <span class="op">*</span> (h<span class="op">-</span><span class="fl">.6</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>wexpr <span class="op">=</span> <span class="fu">substitute</span>(wexpr,<span class="fu">Dict</span>([f <span class="op">=&gt;</span> fexpr]))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>wexpr <span class="op">=</span> <span class="fu">simplify</span>(wexpr,expand<span class="op">=</span><span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<p><span class="math display">\[ \begin{equation}
1.12 h^{3} - 0.4800000000000001 h^{3} k + 0.8 h^{4} k
\end{equation}
\]</span></p>
</div>
</div>
<p>We see that weight scales with an <span class="math inline">\(h^3\)</span> term, and an <span class="math inline">\(h^4\)</span> term with a small coefficient. Now plausibly k is on the order of 0.1 at most, since moving from a baby say 0.1 height to 1 height the skeleton maybe goes from say 0.15 of the body mass to 0.25 of the body mass at most.</p>
<p>Julia symbolics are limited compared to say <a href="https://maxima.sourceforge.io/">Maxima</a> so we’ll rewrite the expression by hand:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>wexpr <span class="op">=</span> (<span class="fl">1.12</span> <span class="op">-</span> <span class="fl">.48</span>)<span class="op">*</span>h<span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">0.8</span><span class="op">*</span>k<span class="op">*</span>h<span class="op">^</span><span class="fl">4</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>h3term <span class="op">=</span> <span class="fl">.64</span><span class="op">*</span>h<span class="op">^</span><span class="fl">3</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>h4term <span class="op">=</span> <span class="fl">.8</span><span class="op">*</span>k<span class="op">*</span>h<span class="op">^</span><span class="fl">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<p><span class="math display">\[ \begin{equation}
0.8 h^{4} k
\end{equation}
\]</span></p>
</div>
</div>
<p>Now let’s substitute some typical values to see the results. and h for a typical person is say 0.6. We see that weight is about 0.24 on whatever units we’re using.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="fu">substitute</span>(h3term,<span class="fu">Dict</span>([h<span class="op">=&gt;</span><span class="fl">.6</span>])))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="fu">substitute</span>(h4term,<span class="fu">Dict</span>([h<span class="op">=&gt;</span><span class="fl">.6</span>,k<span class="op">=&gt;</span><span class="fl">0.1</span>])))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="fu">substitute</span>(<span class="fu">expand_derivatives</span>(<span class="fu">Differential</span>(h)(h3term)),<span class="fu">Dict</span>([h<span class="op">=&gt;</span><span class="fl">.5</span>])))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="fu">substitute</span>(<span class="fu">expand_derivatives</span>(<span class="fu">Differential</span>(h)(h4term)),<span class="fu">Dict</span>([h<span class="op">=&gt;</span><span class="fl">.5</span>,k<span class="op">=&gt;</span><span class="fl">0.1</span>])))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="fu">substitute</span>(<span class="fu">expand_derivatives</span>(<span class="fu">Differential</span>(h)(h3term)),<span class="fu">Dict</span>([h<span class="op">=&gt;</span><span class="fl">.7</span>])))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="fu">substitute</span>(<span class="fu">expand_derivatives</span>(<span class="fu">Differential</span>(h)(h4term)),<span class="fu">Dict</span>([h<span class="op">=&gt;</span><span class="fl">.7</span>,k<span class="op">=&gt;</span><span class="fl">0.1</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.13824
0.010368
0.48
0.04000000000000001
0.9407999999999999
0.10975999999999997</code></pre>
</div>
</div>
<p>We can see that the h^4 term contributes about 10% to the weight, and that it also contributes about 10% to the derivative of weight with height which is more or less a constant contribution across the range of typical heights (0.5 to 0.7). Overall, on the range 0.5 to 0.7 or so, the growth of the skeleton as a fraction of the total can be ignored when discussing crude risk factors associated with heart disease and adiposity. If one wanted to include skeletal factors in a more comprehensive model, perhaps an additional dimensionless ratio measuring wrist or ankle circumference as a fraction of height would be reasonable.</p>
</section>
<section id="does-the-above-analysis-play-out-in-the-data" class="level1">
<h1>Does the above analysis play out in the data?</h1>
<p>Let’s take a look at a few narrow ranges of height, and see how adiposity and percentage body fat vary for each group. We’ll split the dataset into quintiles by height, and then plot % body fat vs adiposity with coloration by quintile</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CategoricalArrays</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>dat.hclass <span class="op">=</span> <span class="fu">cut</span>(dat.heightinch,<span class="fl">5</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="pp">@df</span> dat <span class="fu">scatter</span>(<span class="op">:</span>adiposity,<span class="op">:</span>pctfat; color<span class="op">=</span><span class="fu">levelcode</span>.(<span class="op">:</span>hclass),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Pct Fat vs Adiposity</span><span class="sc">\n</span><span class="st">Colored by quantiles of height"</span>,xlab<span class="op">=</span><span class="st">"Adiposity"</span>,ylab<span class="op">=</span><span class="st">"Percent Body Fat"</span>,legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<p><img src="bodyfat_files/figure-html/cell-7-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>It definitely seems like for every band of height (color) the relationship between the percentage body fat and the adiposity index is more or less the same, in other words the clouds of data are equally mixed and do not have obvious banding or tilting of the sub-clouds. Each height group actually spans most of the adiposity range and does so along a similar horizontal axis.</p>
<p>What about doing the same thing for weight?</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dat.wclass <span class="op">=</span> <span class="fu">cut</span>(dat.weightlbs,<span class="fl">5</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@df</span> dat <span class="fu">scatter</span>(<span class="op">:</span>adiposity,<span class="op">:</span>pctfat; color<span class="op">=</span><span class="fu">levelcode</span>.(<span class="op">:</span>wclass),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Pct Fat vs Adiposity</span><span class="sc">\n</span><span class="st">Colored by quantiles of weight"</span>,xlab<span class="op">=</span><span class="st">"Adiposity"</span>,ylab<span class="op">=</span><span class="st">"Percent Body Fat"</span>,legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<p><img src="bodyfat_files/figure-html/cell-8-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Weight is obviously correlated with adiposity. It’s not surprising that the highest adiposity range tends to be mostly people in the higher weight classes, and the lower adiposity ranges are people in lower weight classes. However there is still a lot of mixing and the variation in percentage body fat within a weight class also indicates variation in adiposity that tracks the percentage body fat. Basically for a given weight, a tall thin person will have low adiposity, and a short fat person will have high adiposity.</p>
<p>Without doing too much extra work, we can estimate how much variation there is in the slope of the line and the overall mean among the different height groups. We can fit a MixedEffects model allowing a perturbation for each group. When we do, it estimates zero differences between the groups, as follows:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModels</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>hm <span class="op">=</span> <span class="fu">fit</span>(MixedModel,<span class="pp">@formula</span>(pctfat <span class="op">~</span> <span class="fl">1</span><span class="op">+</span>adiposity <span class="op">+</span> (<span class="fl">1</span><span class="op">+</span>adiposity <span class="op">|</span> hclass)), dat)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(hm)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Random effect estimates for mean and slope for each group:"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(<span class="fu">ranef</span>(hm)[<span class="fl">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood
 pctfat ~ 1 + adiposity + (1 + adiposity | hclass)
   logLik   -2 logLik     AIC       AICc        BIC    
  -761.9236  1523.8472  1535.8472  1536.1915  1556.9999

Variance components:
            Column     Variance     Std.Dev.    Corr.
hclass   (Intercept)   0.000000000 0.000000000
         adiposity     0.000000118 0.000343273  +NaN
Residual              25.361374272 5.036007771
 Number of obs: 251; levels of grouping factors: 5

  Fixed-effects parameters:
───────────────────────────────────────────────────
                Coef.  Std. Error       z  Pr(&gt;|z|)
───────────────────────────────────────────────────
(Intercept)  -41.7589     2.93618  -14.22    &lt;1e-45
adiposity     40.3881     1.93723   20.85    &lt;1e-95
───────────────────────────────────────────────────
Random effect estimates for mean and slope for each group:</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>2×5 Matrix{Float64}:
 0.0          0.0         0.0          0.0          0.0
 1.36846e-7  -1.25042e-7  2.93976e-7  -3.46615e-8  -2.71118e-7</code></pre>
</div>
</div>
<p>The estimates are actually way too close to zero to be reliable. This usually indicates some kind of issue in fitting, like with numerical stability or something similar. A Bayesian model would be a more comprehensive way to handle this and could allow us to compare individual slope differences, but there’s really no advantage, we have every reason to believe that this should be the case, and the evidence from the data is consistent with that conclusion.</p>
<p>Overall the remaining standard deviation of the residuals is about 5% of body fat, which is likely within the measurement error in the estimates from the dataset, as the estimates themselves are derived by an imperfect formula from underwater weighing.</p>
</section>
<section id="apparently-this-may-be-the-origin-of-the-above-dataset" class="level1">
<h1>Apparently this may be the origin of the above dataset:</h1>
<p><a href="https://jse.amstat.org/v4n1/datasets.johnson.html">Article</a></p>
<p><a href="https://jse.amstat.org/datasets/fat.dat.txt">Dataset</a></p>
</section>
<section id="a-new-dataset-including-men-and-women" class="level1">
<h1>A new dataset including men and women:</h1>
<p><a href="https://www.sciencedirect.com/science/article/pii/S2352340920315365">Article</a></p>
<p>direct link to dataset page:</p>
<p><a href="https://figshare.com/articles/dataset/DATASET_FOR_NEW_BODY_FAT_MEASUREMENT/12982223/2">Dataset</a></p>
<p>Unfortunately this dataset does NOT include measurements of the circumference of the waist!</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>dat2 <span class="op">=</span> CSV.<span class="fu">read</span>(<span class="st">"DATASET FOR NEW BODY FAT MEASUREMENT.csv"</span>,DataFrame; normalizenames<span class="op">=</span><span class="cn">true</span>,delim<span class="op">=</span><span class="st">";"</span>,decimal<span class="op">=</span><span class="ch">','</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="fu">names</span>(dat2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>["GenderM1F2", "Age", "Height_cm", "W_Kg", "BMI", "FatMass_Kg", "FM", "FFM_Kg", "BMR_Kcal", "BoneMass_Kg", "MuscleMass_Kg", "MM_Trunk_Kg", "FFM_Trunk_Kg", "FM_Trunk_Kg", "FM_Trunk", "MM_LA_Kg", "FFM_LA_Kg", "FM_LA_Kg", "FM_LA", "MM_RA_Kg", "FFM_RA_Kg", "FM_RA_Kg", "FM_RA", "MM_LL_Kg", "FFM_LL_Kg", "FM_RL_Kg", "FM_LL", "MM_RL_Kg", "FFM_RL_Kg", "FM_RL_Kg_A", "FM_RL"]</code></pre>
</div>
</div>
<p>The best we could do with it is use the percentage bodyfat to impute waist circumferences using the previous dataset, which would not be reasonable at all for women, and still doesn’t tell us much more about men either.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>